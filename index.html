<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <title>Game Ping-Pong free </title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: black;
            color: white;
            font-family: Arial, sans-serif;
        }

        canvas {
            background: black;
            border: 2px solid white;
        }

        h1 {
            margin-bottom: 20px;
            text-align: center;
        }

        #keyboard button {
            margin: 10px;
            padding: 10px 20px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
        }

        #start {
            background: red;
            color: white;
        }

        #Restart {
            background: greenyellow;
            color: black;
        }

        #up,
        #down {
            background: gray;
            color: white;
        }

        #Pause {
            animation: blink 0.7s steps(2, pause) infinite;
            background: rgb(137, 137, 185);
            border-radius: 2px;
            color: white;
            cursor: pointer;
            font-size: 28px;
        }
    </style>
</head>

<body>
    <h1>Ping-Pong</h1>

    <audio id="background-music" loop>
        <source src="Cyberpunk City.mp3" type="audio/mp3">
    </audio>

    <div>
        <canvas id="pong" width="500" height="300"></canvas>
    </div>

    <div id="keyboard">
        <button id="start">Start</button>
        <button id="Restart">Restart</button>
        <button id="Pause">Pause</button>
        <button id="up"><span class="material-icons">arrow_upward</span></button>
        <button id="down"><span class="material-icons">arrow_downward</span></button>
    </div>

    <script>
        const canvas = document.getElementById("pong");
        const context = canvas.getContext("2d");

        const paddleWidth = 10, paddleHeight = 100;
        const ballRadius = 10;

        let playerY = canvas.height / 2 - paddleHeight / 2;
        let computerY = canvas.height / 2 - paddleHeight / 2;
        let ballX = canvas.width / 2, ballY = canvas.height / 2;
        let ballSpeedX = 4, ballSpeedY = 4;

        let playerScore = 0, computerScore = 0;

        let gameRunning = false;
        let isPaused = false;
        let gameOver = false;

        const backgroundMusic = document.getElementById("background-music");

        function drawRect(x, y, width, height, color) {
            context.fillStyle = color;
            context.fillRect(x, y, width, height);
        }

        function drawCircle(x, y, radius, color) {
            context.fillStyle = color;
            context.beginPath();
            context.arc(x, y, radius, 0, Math.PI * 2);
            context.closePath();
            context.fill();
        }

        function drawText(text, x, y, color) {
            context.fillStyle = color;
            context.font = "30px Arial";
            context.fillText(text, x, y);
        }

        // ----------------------------
        //   IA PLUS FACILE Ã€ BATTRE
        // ----------------------------
        function moveAI() {
            let aiCenter = computerY + paddleHeight / 2;

            let error = Math.random() * 20 - 10;  
            let target = ballY + error;

            computerY += (target - aiCenter) * 0.08;

            if (computerY < 0) computerY = 0;
            if (computerY + paddleHeight > canvas.height)
                computerY = canvas.height - paddleHeight;
        }

        // ----------------------------
        //   CONDITIONS DE VICTOIRE
        // ----------------------------
        function checkWinner() {
            if (playerScore >= 20) {
                gameOver = true;
                gameRunning = false;
                backgroundMusic.pause();
                alert("ðŸŽ‰ YOU WIN !!!");
            }

            if (computerScore >= 20) {
                gameOver = true;
                gameRunning = false;
                backgroundMusic.pause();
                alert("ðŸ’€ YOU LOSE !");
            }
        }

        function update() {
            if (!gameRunning || isPaused || gameOver) return;

            ballX += ballSpeedX;
            ballY += ballSpeedY;

            if (ballY + ballRadius > canvas.height || ballY - ballRadius < 0) {
                ballSpeedY = -ballSpeedY;
            }

            if (
                ballX - ballRadius < paddleWidth &&
                ballY > playerY &&
                ballY < playerY + paddleHeight
            ) {
                ballSpeedX = -ballSpeedX;
            }

            if (
                ballX + ballRadius > canvas.width - paddleWidth &&
                ballY > computerY &&
                ballY < computerY + paddleHeight
            ) {
                ballSpeedX = -ballSpeedX;
            }

            if (ballX < 0) {
                computerScore++;
                resetBall();
                checkWinner();
            } else if (ballX > canvas.width) {
                playerScore++;
                resetBall();
                checkWinner();
            }

            moveAI();
        }

        function resetBall() {
            ballX = canvas.width / 2;
            ballY = canvas.height / 2;
            ballSpeedX = -ballSpeedX;
        }

        function togglePause() {
            if (!gameRunning || gameOver) return;

            isPaused = !isPaused;
            document.getElementById("Pause").textContent =
                isPaused ? "Resume" : "Pause";

            if (isPaused) {
                backgroundMusic.pause();
            } else {
                backgroundMusic.play();
            }
        }

        function render() {
            drawRect(0, 0, canvas.width, canvas.height, "black");

            drawRect(canvas.width / 2 - 1, 0, 2, canvas.height, "white");

            drawText(playerScore, canvas.width / 4, 50, "white");
            drawText(computerScore, 3 * canvas.width / 4, 50, "white");

            drawRect(0, playerY, paddleWidth, paddleHeight, "violet");
            drawRect(canvas.width - paddleWidth, computerY, paddleWidth, paddleHeight, "red");

            drawCircle(ballX, ballY, ballRadius, "white");
        }

        document.getElementById("up").addEventListener("click", () => {
            playerY = Math.max(playerY - 40, 0);
        });

        document.getElementById("down").addEventListener("click", () => {
            playerY = Math.min(playerY + 40, canvas.height - paddleHeight);
        });

        document.getElementById("start").addEventListener("click", () => {
            if (!gameRunning && !gameOver) {
                gameRunning = true;
                isPaused = false;
                document.getElementById("Pause").textContent = "Pause";
                StartGame();
                backgroundMusic.play();
            }
        });

        document.getElementById("Restart").addEventListener("click", () => {
            playerScore = 0;
            computerScore = 0;
            gameRunning = false;
            gameOver = false;
            resetBall();
            render();
        });

        document.getElementById("Pause").addEventListener("click", togglePause);

        function StartGame() {
            if (gameRunning && !gameOver) {
                if (!isPaused) update();
                render();
                requestAnimationFrame(StartGame);
            }
        }

        render();
    </script>
</body>

</html>


