<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ping-Pong Responsive</title>

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <style>
        body {
            margin: 0;
            padding: 0;
            background: black;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: Arial, sans-serif;
        }

        h1 {
            margin: 10px 0;
            text-align: center;
            font-size: 5vw;
            max-font-size: 30px;
        }

        /* CANVAS RESPONSIVE */
        #container {
            width: 95vw;
            max-width: 700px;
        }

        canvas {
            width: 100%;
            height: auto;
            background: black;
            border: 2px solid white;
        }

        /* BOTTONI PICCOLI E ORIZZONTALI */
        #keyboard {
            margin-top: 10px;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 6px;
        }

        #keyboard button {
            padding: 6px 12px;
            font-size: 14px;
            border-radius: 5px;
            cursor: pointer;
            border: none;
        }

        #start { background: red; color: white; }
        #Restart { background: yellowgreen; color: black; font-weight: bold; }
        #Pause { background: steelblue; color: white; }
        #up, #down { background: rgb(90, 90, 90); color: white; }

        /* Icone piccole */
        .material-icons {
            font-size: 20px;
        }
    </style>
</head>

<body>

    <h1>Ping-Pong</h1>

    <audio id="background-music" loop>
        <source src="Cyberpunk City.mp3" type="audio/mp3">
    </audio>

    <div id="container">
        <canvas id="pong"></canvas>
    </div>

    <div id="keyboard">
        <button id="start">Start</button>
        <button id="Restart">Restart</button>
        <button id="Pause">Pause</button>
        <button id="up"><span class="material-icons">arrow_upward</span></button>
        <button id="down"><span class="material-icons">arrow_downward</span></button>
    </div>

    <script>
        const canvas = document.getElementById("pong");
        const context = canvas.getContext("2d");

        // ðŸ“Œ CANVAS RESPONSIVE
        function resizeCanvas() {
            const width = document.getElementById("container").clientWidth;
            canvas.width = width;
            canvas.height = width * 0.6;
        }
        window.addEventListener("resize", resizeCanvas);
        resizeCanvas();

        // VARIABILI DI GIOCO
        const paddleWidth = 10;
        let paddleHeight;

        let playerY, computerY;
        let ballX, ballY, ballSpeedX, ballSpeedY;

        let ballRadius;
        let playerScore = 0, computerScore = 0;

        let gameRunning = false;
        let isPaused = false;
        let gameOver = false;

        const bgMusic = document.getElementById("background-music");

        function resetSizes() {
            paddleHeight = canvas.height * 0.35;
            ballRadius = canvas.width * 0.02;

            playerY = canvas.height / 2 - paddleHeight / 2;
            computerY = canvas.height / 2 - paddleHeight / 2;

            ballX = canvas.width / 2;
            ballY = canvas.height / 2;

            ballSpeedX = canvas.width * 0.01;
            ballSpeedY = canvas.height * 0.01;
        }

        resetSizes();

        // FUNZIONI DI DISEGNO
        function rect(x, y, w, h, c) {
            context.fillStyle = c;
            context.fillRect(x, y, w, h);
        }

        function circle(x, y, r, c) {
            context.fillStyle = c;
            context.beginPath();
            context.arc(x, y, r, 0, Math.PI * 2);
            context.fill();
        }

        function text(t, x, y, c) {
            context.fillStyle = c;
            context.font = (canvas.width * 0.08) + "px Arial";
            context.fillText(t, x, y);
        }

        // IA
        function moveAI() {
            let aiCenter = computerY + paddleHeight / 2;
            let target = ballY + (Math.random() * 40 - 20);
            computerY += (target - aiCenter) * 0.07;

            if (computerY < 0) computerY = 0;
            if (computerY + paddleHeight > canvas.height)
                computerY = canvas.height - paddleHeight;
        }

        function update() {
            if (!gameRunning || isPaused || gameOver) return;

            ballX += ballSpeedX;
            ballY += ballSpeedY;

            if (ballY - ballRadius < 0 || ballY + ballRadius > canvas.height)
                ballSpeedY = -ballSpeedY;

            if (
                ballX - ballRadius < paddleWidth &&
                ballY > playerY &&
                ballY < playerY + paddleHeight
            ) ballSpeedX = -ballSpeedX;

            if (
                ballX + ballRadius > canvas.width - paddleWidth &&
                ballY > computerY &&
                ballY < computerY + paddleHeight
            ) ballSpeedX = -ballSpeedX;

            if (ballX < 0) {
                computerScore++;
                resetSizes();
            } else if (ballX > canvas.width) {
                playerScore++;
                resetSizes();
            }

            moveAI();
        }

        function render() {
            rect(0, 0, canvas.width, canvas.height, "black");

            rect(canvas.width / 2 - 1, 0, 2, canvas.height, "white");

            text(playerScore, canvas.width * 0.25, canvas.height * 0.15, "white");
            text(computerScore, canvas.width * 0.7, canvas.height * 0.15, "white");

            rect(0, playerY, paddleWidth, paddleHeight, "violet");
            rect(canvas.width - paddleWidth, computerY, paddleWidth, paddleHeight, "red");

            circle(ballX, ballY, ballRadius, "white");
        }

        // ðŸ”¼ðŸ”½ Bottoni movimento
        document.getElementById("up").onclick = () => {
            playerY = Math.max(playerY - canvas.height * 0.1, 0);
        };
        document.getElementById("down").onclick = () => {
            playerY = Math.min(playerY + canvas.height * 0.1, canvas.height - paddleHeight);
        };

        // START
        document.getElementById("start").onclick = () => {
            if (!gameRunning && !gameOver) {
                resetSizes();
                gameRunning = true;
                bgMusic.play();
                loop();
            }
        };

        // RESTART
        document.getElementById("Restart").onclick = () => {
            playerScore = 0;
            computerScore = 0;
            gameRunning = false;
            isPaused = false;
            gameOver = false;
            resetSizes();
            render();
        };

        // PAUSA
        document.getElementById("Pause").onclick = () => {
            if (!gameRunning) return;
            isPaused = !isPaused;
            document.getElementById("Pause").innerText =
                isPaused ? "Resume" : "Pause";

            if (isPaused) bgMusic.pause();
            else bgMusic.play();
        };

        // LOOP
        function loop() {
            if (gameRunning && !gameOver) {
                update();
                render();
                requestAnimationFrame(loop);
            }
        }

        render();
    </script>

</body>
</html>


